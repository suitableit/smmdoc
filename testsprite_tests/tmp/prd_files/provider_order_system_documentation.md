# ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЕрж░рзНржбрж╛рж░ рж╕рж┐рж╕рзНржЯрзЗржо - рж╕ржорзНржкрзВрж░рзНржг ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи

## рзз. рж╕рж┐рж╕рзНржЯрзЗржо ржУржнрж╛рж░ржнрж┐ржЙ

SMMDOC ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЕрж░рзНржбрж╛рж░ ржЯрзНрж░рзНржпрж╛ржХрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо ржПржХржЯрж┐ ржЙржирзНржиржд ржЕрж░рзНржбрж╛рж░ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ рж╕рж┐рж╕рзНржЯрзЗржо ржпрж╛ ржмрж╛рж╣рзНржпрж┐ржХ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ржжрзЗрж░ рж╕рж╛ржерзЗ ржЕрж░рзНржбрж╛рж░ ржлрж░ржУржпрж╝рж╛рж░рзНржб ржХрж░рзЗ ржПржмржВ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ рж╕рж┐ржЩрзНржХ ржХрж░рзЗред ржПржЗ рж╕рж┐рж╕рзНржЯрзЗржоржЯрж┐ ржЗржЙржЬрж╛рж░ ржПржмржВ ржПржбржорж┐ржиржжрзЗрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ ржЕрж░рзНржбрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░рзЗ ржПржмржВ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ рж╕ржорж╕рзНржпрж╛рж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕржкрж╢ржи ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред

## рзи. ржмрж░рзНрждржорж╛ржи рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ ржЕржмрж╕рзНржерж╛

### тЬЕ рж╕ржорзНржкржирзНржи ржХрж╛ржЬрж╕ржорзВрж╣

#### рзи.рзз ржбрзЗржЯрж╛ржмрзЗрж╕ рж╕рзНржХрж┐ржорж╛ ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи
- **Provider Table Integration**: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЯрзЗржмрж┐рж▓ рж╕ржорзНржкрзВрж░рзНржгржнрж╛ржмрзЗ ржЗржирзНржЯрж┐ржЧрзНрж░рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- **Service-Provider Relations**: рж╕рж╛рж░рзНржнрж┐рж╕ ржПржмржВ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗрж░ ржоржзрзНржпрзЗ рж╕ржорзНржкрж░рзНржХ рж╕рзНржерж╛ржкржи ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- **Order Tracking Schema**: ржЕрж░рзНржбрж╛рж░ ржЯрзНрж░рзНржпрж╛ржХрж┐ржВ ржПрж░ ржЬржирзНржп ржирждрзБржи рж╕рзНржХрж┐ржорж╛ ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ

#### рзи.рзи ржХрзЛрж░ ржХржорзНржкрзЛржирзЗржирзНржЯрж╕
- **ProviderOrderForwarder Class**: ржмрж╛рж╣рзНржпрж┐ржХ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ржжрзЗрж░ рж╕рж╛ржерзЗ ржпрзЛржЧрж╛ржпрзЛржЧрзЗрж░ ржЬржирзНржп ржХрзНрж▓рж╛рж╕ рждрзИрж░рж┐
- **Order Forwarding Logic**: ржЕрж░рзНржбрж╛рж░ ржлрж░ржУржпрж╝рж╛рж░рзНржбрж┐ржВ рж▓ржЬрж┐ржХ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- **Provider Order Logging**: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЕрж░рзНржбрж╛рж░ рж▓ржЧрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо рждрзИрж░рж┐

#### рзи.рзй API ржПржирзНржбржкржпрж╝рзЗржирзНржЯрж╕
- **User Order Creation API**: ржЗржЙржЬрж╛рж░ ржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐рж░ API ржЖржкржбрзЗржЯ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- **Provider Order Placement API**: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗ ржЕрж░рзНржбрж╛рж░ ржкрж╛ржарж╛ржирзЛрж░ API рждрзИрж░рж┐
- **Admin Sync API**: ржПржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓рзЗ ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓ рж╕рж┐ржЩрзНржХ API
- **Cron Sync System**: ржЕржЯрзЛржорзЗржЯрж┐ржХ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ рж╕рж┐ржЩрзНржХ рж╕рж┐рж╕рзНржЯрзЗржо

#### рзи.рзк ржПржбржорж┐ржи ржЗржирзНржЯрж╛рж░ржлрзЗрж╕
- **Admin Order Page**: ржПржбржорж┐ржи ржЕрж░рзНржбрж╛рж░ ржкрзЗржЬрзЗ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрж╛ржирзЛ рж╣ржЪрзНржЫрзЗ
- **Manual Sync Option**: ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓ рж╕рж┐ржЩрзНржХ ржЕржкрж╢ржи ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ

### тЭМ ржЕрж╕ржорзНржкрзВрж░рзНржг/ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржХрж╛ржЬрж╕ржорзВрж╣

#### рзи.рзл ржЗржЙржЬрж╛рж░ ржЗржирзНржЯрж╛рж░ржлрзЗрж╕ рж╕ржорж╕рзНржпрж╛
- **User Status Display**: ржЗржЙржЬрж╛рж░рж░рж╛ ржПржЦржиржУ ржлрзЗржЗрж▓рзНржб рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрждрзЗ ржкрж╛ржЪрзНржЫрзЗ (рж╢рзБржзрзБ ржкрзЗржирзНржбрж┐ржВ ржжрзЗржЦрж╛ржирзЛ ржЙржЪрж┐ржд)
- **Status Filtering Logic**: ржЗржЙржЬрж╛рж░ ржПржмржВ ржПржбржорж┐ржирзЗрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ ржирзЗржЗ

#### рзи.рзм рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржлрж┐ржЪрж╛рж░
- **Resubmit Order Option**: рзй-ржбржЯ ржорзЗржирзБрждрзЗ рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕржкрж╢ржи ржирзЗржЗ
- **Balance Detection**: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржХрж░рж╛рж░ рж╕рж┐рж╕рзНржЯрзЗржо ржирзЗржЗ
- **Resubmit API**: рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ API ржирзЗржЗ

## рзй. ржЗржЙржЬрж╛рж░ рж░рж┐ржХрзЛржпрж╝рж╛рж░ржорзЗржирзНржЯ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг

### рзй.рзз ржЗржЙржЬрж╛рж░ ржЕрж░рзНржбрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕
**ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝рждрж╛**: ржЗржЙржЬрж╛рж░ ржЕрж░рзНржбрж╛рж░ ржХрж░рж▓рзЗ рж╕ржмрж╕ржоржпрж╝ "ржкрзЗржирзНржбрж┐ржВ" рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрж╛ржмрзЗ, "ржлрзЗржЗрж▓рзНржб" ржжрзЗржЦрж╛ржмрзЗ ржирж╛ред

**ржмрж░рзНрждржорж╛ржи рж╕ржорж╕рзНржпрж╛**: ржЗржЙржЬрж╛рж░рж░рж╛ ржлрзЗржЗрж▓рзНржб рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрждрзЗ ржкрж╛ржЪрзНржЫрзЗред

**рж╕ржорж╛ржзрж╛ржи**: ржЗржЙржЬрж╛рж░ ржЗржирзНржЯрж╛рж░ржлрзЗрж╕рзЗ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ рж▓ржЬрж┐ржХ ржпрзЛржЧ ржХрж░рждрзЗ рж╣ржмрзЗред

### рзй.рзи ржПржбржорж┐ржи ржЕрж░рзНржбрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕
**ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝рждрж╛**: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗрж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржирж╛ ржерж╛ржХрж▓рзЗ ржПржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓рзЗ "ржлрзЗржЗрж▓рзНржб" рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрж╛ржмрзЗред

**ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛**: ржПржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓рзЗ ржлрзЗржЗрж▓рзНржб рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрж╛ржирзЛ рж╣ржЪрзНржЫрзЗред

### рзй.рзй рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕрж░рзНржбрж╛рж░ ржлрж┐ржЪрж╛рж░
**ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝рждрж╛**: 
- ржлрзЗржЗрж▓рзНржб ржЕрж░рзНржбрж╛рж░рзЗрж░ рзй-ржбржЯ ржорзЗржирзБрждрзЗ "Resubmit Order" ржЕржкрж╢ржи
- ржмрзНржпрж╛рж▓рзЗржирзНрж╕ рж▓рзЛржб ржХрж░рж╛рж░ ржкрж░ рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржХрж░рж▓рзЗ рж╕ржлрж▓ржнрж╛ржмрзЗ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗ рж╣рж┐ржЯ ржХрж░ржмрзЗ

**ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛**: ржПржЗ ржлрж┐ржЪрж╛рж░ ржПржЦржиржУ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯ ржХрж░рж╛ рж╣ржпрж╝ржирж┐ред

## рзк. рж╕рж┐рж╕рзНржЯрзЗржо ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛ

### рзк.рзз ржмрж░рзНрждржорж╛ржи ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛ
```
рзз. ржЗржЙржЬрж╛рж░ ржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐ ржХрж░рзЗ
рзи. рж╕рж┐рж╕рзНржЯрзЗржо рж╕рж╛рж░рзНржнрж┐рж╕рзЗрж░ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЪрзЗржХ ржХрж░рзЗ
рзй. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗ ржЕрж░рзНржбрж╛рж░ ржлрж░ржУржпрж╝рж╛рж░рзНржб ржХрж░рзЗ
рзк. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ рж░рзЗрж╕ржкржирзНрж╕ рж▓ржЧ ржХрж░рзЗ
рзл. ржХрзНрж░ржи ржЬржм ржжрж┐ржпрж╝рзЗ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ рж╕рж┐ржЩрзНржХ ржХрж░рзЗ
рзм. ржПржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓рзЗ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрж╛ржпрж╝
```

### рзк.рзи ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛ
```
рзз. ржЗржЙржЬрж╛рж░ ржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐ ржХрж░рзЗ
рзи. рж╕рж┐рж╕рзНржЯрзЗржо рж╕рж╛рж░рзНржнрж┐рж╕рзЗрж░ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЪрзЗржХ ржХрж░рзЗ
рзй. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗ ржЕрж░рзНржбрж╛рж░ ржлрж░ржУржпрж╝рж╛рж░рзНржб ржХрж░рзЗ
рзк. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржХрж░рзЗ
рзл. ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржирж╛ ржерж╛ржХрж▓рзЗ ржлрзЗржЗрж▓рзНржб ржорж╛рж░рзНржХ ржХрж░рзЗ
рзм. ржЗржЙржЬрж╛рж░ржХрзЗ "ржкрзЗржирзНржбрж┐ржВ" ржжрзЗржЦрж╛ржпрж╝, ржПржбржорж┐ржиржХрзЗ "ржлрзЗржЗрж▓рзНржб" ржжрзЗржЦрж╛ржпрж╝
рзн. ржПржбржорж┐ржи рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕржкрж╢ржи ржкрж╛ржпрж╝
рзо. рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржХрж░рж▓рзЗ ржЖржмрж╛рж░ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗ ржкрж╛ржарж╛ржпрж╝
```

## рзл. ржбрзЗржЯрж╛ржмрзЗрж╕ рж╕рзНржХрж┐ржорж╛ рж░рж┐ржХрзЛржпрж╝рж╛рж░ржорзЗржирзНржЯ

### рзл.рзз ржмрж░рзНрждржорж╛ржи рж╕рзНржХрж┐ржорж╛
```sql
-- NewOrder Table (ржмрж░рзНрждржорж╛ржи)
CREATE TABLE neworder (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    service_id INTEGER,
    link TEXT,
    quantity INTEGER,
    charge DECIMAL,
    start_count INTEGER,
    status VARCHAR(50),
    remains INTEGER,
    provider_order_id VARCHAR(255),
    provider_id INTEGER,
    provider_status VARCHAR(50),
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

-- ProviderOrderTracking Table
CREATE TABLE provider_order_tracking (
    id SERIAL PRIMARY KEY,
    order_id INTEGER REFERENCES neworder(id),
    provider_id INTEGER,
    provider_order_id VARCHAR(255),
    provider_status VARCHAR(50),
    last_sync_at TIMESTAMP,
    created_at TIMESTAMP
);

-- ProviderApiLog Table
CREATE TABLE provider_api_log (
    id SERIAL PRIMARY KEY,
    order_id INTEGER,
    provider_id INTEGER,
    action VARCHAR(50),
    request_data TEXT,
    response_data TEXT,
    status_code INTEGER,
    created_at TIMESTAMP
);
```

### рзл.рзи ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╕рзНржХрж┐ржорж╛ ржЖржкржбрзЗржЯ
```sql
-- NewOrder Table ржП ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рждрзЗ рж╣ржмрзЗ
ALTER TABLE neworder ADD COLUMN resubmit_count INTEGER DEFAULT 0;
ALTER TABLE neworder ADD COLUMN last_resubmit_at TIMESTAMP;
ALTER TABLE neworder ADD COLUMN balance_check_status VARCHAR(50);
ALTER TABLE neworder ADD COLUMN user_visible_status VARCHAR(50);
ALTER TABLE neworder ADD COLUMN admin_visible_status VARCHAR(50);
```

## рзм. API ржПржирзНржбржкржпрж╝рзЗржирзНржЯ рж░рж┐ржХрзЛржпрж╝рж╛рж░ржорзЗржирзНржЯ

### рзм.рзз ржмрж░рзНрждржорж╛ржи API ржПржирзНржбржкржпрж╝рзЗржирзНржЯрж╕
```
POST /api/orders/create-orders - ржЗржЙржЬрж╛рж░ ржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐
POST /api/orders/place-to-provider - ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗ ржЕрж░рзНржбрж╛рж░ ржкрж╛ржарж╛ржирзЛ
GET /api/cron/sync-provider-orders - ржЕржЯрзЛ рж╕рж┐ржЩрзНржХ
POST /api/admin/provider-sync - ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓ рж╕рж┐ржЩрзНржХ
```

### рзм.рзи ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржирждрзБржи API ржПржирзНржбржкржпрж╝рзЗржирзНржЯрж╕
```
POST /api/admin/orders/resubmit - ржЕрж░рзНржбрж╛рж░ рж░рж┐рж╕рж╛ржмржорж┐ржЯ
GET /api/orders/user-status/{orderId} - ржЗржЙржЬрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕
GET /api/admin/orders/admin-status/{orderId} - ржПржбржорж┐ржи рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕
POST /api/providers/check-balance - ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ
```

### рзм.рзй API ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯрзЗрж╢ржи ржкрзНрж▓рзНржпрж╛ржи

#### рзм.рзй.рзз Resubmit Order API
```typescript
// /api/admin/orders/resubmit/route.ts
export async function POST(request: Request) {
  try {
    const { orderId } = await request.json();
    
    // ржЕрж░рзНржбрж╛рж░ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛
    const order = await prisma.newOrder.findUnique({
      where: { id: orderId },
      include: { service: { include: { provider: true } } }
    });
    
    if (!order) {
      return NextResponse.json({ error: 'ржЕрж░рзНржбрж╛рж░ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐' }, { status: 404 });
    }
    
    // ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ
    const balanceCheck = await checkProviderBalance(order.service.provider);
    
    if (!balanceCheck.hasBalance) {
      return NextResponse.json({ 
        error: 'ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗрж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЕржкрж░рзНржпрж╛ржкрзНржд',
        balance: balanceCheck.balance 
      }, { status: 400 });
    }
    
    // ржЕрж░рзНржбрж╛рж░ рж░рж┐рж╕рж╛ржмржорж┐ржЯ
    const resubmitResult = await resubmitOrderToProvider(order);
    
    // ржбрзЗржЯрж╛ржмрзЗрж╕ ржЖржкржбрзЗржЯ
    await prisma.newOrder.update({
      where: { id: orderId },
      data: {
        resubmit_count: { increment: 1 },
        last_resubmit_at: new Date(),
        status: 'pending',
        admin_visible_status: 'resubmitted',
        user_visible_status: 'pending'
      }
    });
    
    return NextResponse.json({ 
      success: true, 
      message: 'ржЕрж░рзНржбрж╛рж░ рж╕ржлрж▓ржнрж╛ржмрзЗ рж░рж┐рж╕рж╛ржмржорж┐ржЯ рж╣ржпрж╝рзЗржЫрзЗ',
      providerOrderId: resubmitResult.orderId
    });
    
  } catch (error) {
    return NextResponse.json({ error: 'рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ' }, { status: 500 });
  }
}
```

#### рзм.рзй.рзи User Status API
```typescript
// /api/orders/user-status/[orderId]/route.ts
export async function GET(request: Request, { params }: { params: { orderId: string } }) {
  try {
    const order = await prisma.newOrder.findUnique({
      where: { id: parseInt(params.orderId) }
    });
    
    if (!order) {
      return NextResponse.json({ error: 'ржЕрж░рзНржбрж╛рж░ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐' }, { status: 404 });
    }
    
    // ржЗржЙржЬрж╛рж░рзЗрж░ ржЬржирзНржп рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░
    let userStatus = order.status;
    if (order.status === 'failed' || order.status === 'cancelled') {
      userStatus = 'pending'; // ржЗржЙржЬрж╛рж░ржХрзЗ рж╕ржмрж╕ржоржпрж╝ ржкрзЗржирзНржбрж┐ржВ ржжрзЗржЦрж╛ржмрзЗ
    }
    
    return NextResponse.json({
      orderId: order.id,
      status: userStatus,
      quantity: order.quantity,
      charge: order.charge,
      created_at: order.created_at
    });
    
  } catch (error) {
    return NextResponse.json({ error: 'рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ рж▓рзЛржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ' }, { status: 500 });
  }
}
```

## рзн. UI ржкрж░рж┐ржмрж░рзНрждржи рж░рж┐ржХрзЛржпрж╝рж╛рж░ржорзЗржирзНржЯ

### рзн.рзз ржПржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓ ржкрж░рж┐ржмрж░рзНрждржи

#### рзн.рзз.рзз ржЕрж░рзНржбрж╛рж░ ржЯрзЗржмрж┐рж▓рзЗ рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕржкрж╢ржи
```tsx
// app/(protected)/admin/orders/page.tsx ржП ржпрзЛржЧ ржХрж░рждрзЗ рж╣ржмрзЗ

const OrderActionsMenu = ({ order }: { order: Order }) => {
  const [isResubmitting, setIsResubmitting] = useState(false);
  
  const handleResubmit = async () => {
    setIsResubmitting(true);
    try {
      const response = await fetch('/api/admin/orders/resubmit', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ orderId: order.id })
      });
      
      const result = await response.json();
      
      if (response.ok) {
        toast.success('ржЕрж░рзНржбрж╛рж░ рж╕ржлрж▓ржнрж╛ржмрзЗ рж░рж┐рж╕рж╛ржмржорж┐ржЯ рж╣ржпрж╝рзЗржЫрзЗ');
        // ржЯрзЗржмрж┐рж▓ рж░рж┐ржлрзНрж░рзЗрж╢ ржХрж░рж╛
        window.location.reload();
      } else {
        toast.error(result.error || 'рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ');
      }
    } catch (error) {
      toast.error('ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ');
    } finally {
      setIsResubmitting(false);
    }
  };
  
  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" className="h-8 w-8 p-0">
          <MoreHorizontal className="h-4 w-4" />
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <DropdownMenuItem onClick={() => {/* View Details */}}>
          ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржжрзЗржЦрзБржи
        </DropdownMenuItem>
        
        {order.status === 'failed' && (
          <DropdownMenuItem 
            onClick={handleResubmit}
            disabled={isResubmitting}
            className="text-blue-600"
          >
            {isResubmitting ? 'рж░рж┐рж╕рж╛ржмржорж┐ржЯ рж╣ржЪрзНржЫрзЗ...' : 'Resubmit Order'}
          </DropdownMenuItem>
        )}
        
        <DropdownMenuItem onClick={() => {/* Cancel Order */}}>
          ржЕрж░рзНржбрж╛рж░ ржмрж╛рждрж┐рж▓ ржХрж░рзБржи
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
};
```

#### рзн.рзз.рзи рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржЗржирзНржбрж┐ржХрзЗржЯрж░
```tsx
const StatusBadge = ({ status, isAdmin }: { status: string, isAdmin: boolean }) => {
  const getStatusDisplay = () => {
    if (!isAdmin && (status === 'failed' || status === 'cancelled')) {
      return { text: 'ржкрзЗржирзНржбрж┐ржВ', color: 'bg-yellow-100 text-yellow-800' };
    }
    
    switch (status) {
      case 'pending':
        return { text: 'ржкрзЗржирзНржбрж┐ржВ', color: 'bg-yellow-100 text-yellow-800' };
      case 'processing':
        return { text: 'ржкрзНрж░рж╕рзЗрж╕рж┐ржВ', color: 'bg-blue-100 text-blue-800' };
      case 'completed':
        return { text: 'рж╕ржорзНржкржирзНржи', color: 'bg-green-100 text-green-800' };
      case 'failed':
        return { text: 'ржмрзНржпрж░рзНрже', color: 'bg-red-100 text-red-800' };
      case 'cancelled':
        return { text: 'ржмрж╛рждрж┐рж▓', color: 'bg-gray-100 text-gray-800' };
      default:
        return { text: status, color: 'bg-gray-100 text-gray-800' };
    }
  };
  
  const { text, color } = getStatusDisplay();
  
  return (
    <span className={`px-2 py-1 rounded-full text-xs font-medium ${color}`}>
      {text}
    </span>
  );
};
```

### рзн.рзи ржЗржЙржЬрж╛рж░ ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб ржкрж░рж┐ржмрж░рзНрждржи

#### рзн.рзи.рзз ржЕрж░рзНржбрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ
```tsx
// ржЗржЙржЬрж╛рж░ ржЕрж░рзНржбрж╛рж░ рж▓рж┐рж╕рзНржЯрзЗ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗ
const UserOrderList = () => {
  const [orders, setOrders] = useState([]);
  
  useEffect(() => {
    const fetchOrders = async () => {
      const response = await fetch('/api/user/orders');
      const data = await response.json();
      
      // ржЗржЙржЬрж╛рж░рзЗрж░ ржЬржирзНржп рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░
      const filteredOrders = data.map(order => ({
        ...order,
        status: (order.status === 'failed' || order.status === 'cancelled') 
          ? 'pending' 
          : order.status
      }));
      
      setOrders(filteredOrders);
    };
    
    fetchOrders();
  }, []);
  
  return (
    <div className="space-y-4">
      {orders.map(order => (
        <div key={order.id} className="border rounded-lg p-4">
          <div className="flex justify-between items-center">
            <div>
              <h3 className="font-medium">ржЕрж░рзНржбрж╛рж░ #{order.id}</h3>
              <p className="text-sm text-gray-600">{order.service_name}</p>
            </div>
            <StatusBadge status={order.status} isAdmin={false} />
          </div>
        </div>
      ))}
    </div>
  );
};
```

## рзо. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ рж╕рж┐рж╕рзНржЯрзЗржо

### рзо.рзз ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржлрж╛ржВрж╢ржи
```typescript
// lib/services/providerBalanceChecker.ts
export class ProviderBalanceChecker {
  static async checkBalance(provider: Provider): Promise<BalanceCheckResult> {
    try {
      const response = await fetch(`${provider.api_url}/balance`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          key: provider.api_key,
          action: 'balance'
        })
      });
      
      const data = await response.json();
      
      return {
        hasBalance: parseFloat(data.balance) > 0,
        balance: parseFloat(data.balance),
        currency: data.currency || 'USD',
        lastChecked: new Date()
      };
      
    } catch (error) {
      console.error('ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛:', error);
      return {
        hasBalance: false,
        balance: 0,
        currency: 'USD',
        lastChecked: new Date(),
        error: 'ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржХрж░рждрзЗ ржкрж╛рж░рж┐ржирж┐'
      };
    }
  }
  
  static async checkAllProviders(): Promise<Map<number, BalanceCheckResult>> {
    const providers = await prisma.provider.findMany();
    const results = new Map<number, BalanceCheckResult>();
    
    for (const provider of providers) {
      const result = await this.checkBalance(provider);
      results.set(provider.id, result);
    }
    
    return results;
  }
}

interface BalanceCheckResult {
  hasBalance: boolean;
  balance: number;
  currency: string;
  lastChecked: Date;
  error?: string;
}
```

### рзо.рзи ржЕрж░рзНржбрж╛рж░ ржлрж░ржУржпрж╝рж╛рж░рзНржбрж┐ржВ ржП ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи
```typescript
// lib/services/providerOrderForwarder.ts ржП ржЖржкржбрзЗржЯ
export class ProviderOrderForwarder {
  static async forwardOrder(order: NewOrder): Promise<ForwardResult> {
    try {
      // ржкрзНрж░ржержорзЗ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржХрж░рж╛
      const balanceCheck = await ProviderBalanceChecker.checkBalance(order.service.provider);
      
      if (!balanceCheck.hasBalance) {
        // ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржирж╛ ржерж╛ржХрж▓рзЗ ржлрзЗржЗрж▓рзНржб ржорж╛рж░рзНржХ ржХрж░рж╛
        await prisma.newOrder.update({
          where: { id: order.id },
          data: {
            status: 'failed',
            admin_visible_status: 'failed_insufficient_balance',
            user_visible_status: 'pending',
            balance_check_status: 'insufficient'
          }
        });
        
        return {
          success: false,
          error: 'ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗрж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЕржкрж░рзНржпрж╛ржкрзНржд',
          balance: balanceCheck.balance
        };
      }
      
      // ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржерж╛ржХрж▓рзЗ ржЕрж░рзНржбрж╛рж░ ржкрж╛ржарж╛ржирзЛ
      const response = await this.sendOrderToProvider(order);
      
      return response;
      
    } catch (error) {
      console.error('ржЕрж░рзНржбрж╛рж░ ржлрж░ржУржпрж╝рж╛рж░рзНржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛:', error);
      return {
        success: false,
        error: 'ржЕрж░рзНржбрж╛рж░ ржкрж╛ржарж╛рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ'
      };
    }
  }
}
```

## рзп. ржЯрзЗрж╕рзНржЯрж┐ржВ ржкрзНрж▓рзНржпрж╛ржи

### рзп.рзз ржЗржЙржирж┐ржЯ ржЯрзЗрж╕рзНржЯ
```typescript
// tests/providerOrderSystem.test.ts
describe('Provider Order System', () => {
  test('ржЗржЙржЬрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ', async () => {
    const order = await createTestOrder({ status: 'failed' });
    const userStatus = await getUserOrderStatus(order.id);
    expect(userStatus.status).toBe('pending');
  });
  
  test('ржПржбржорж┐ржи рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржкрзНрж░ржжрж░рзНрж╢ржи', async () => {
    const order = await createTestOrder({ status: 'failed' });
    const adminStatus = await getAdminOrderStatus(order.id);
    expect(adminStatus.status).toBe('failed');
  });
  
  test('рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕрж░рзНржбрж╛рж░', async () => {
    const order = await createTestOrder({ status: 'failed' });
    const result = await resubmitOrder(order.id);
    expect(result.success).toBe(true);
  });
  
  test('ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ', async () => {
    const provider = await createTestProvider();
    const balanceResult = await ProviderBalanceChecker.checkBalance(provider);
    expect(balanceResult).toHaveProperty('hasBalance');
    expect(balanceResult).toHaveProperty('balance');
  });
});
```

### рзп.рзи ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи ржЯрзЗрж╕рзНржЯ
```typescript
describe('Order Workflow Integration', () => {
  test('рж╕ржорзНржкрзВрж░рзНржг ржЕрж░рзНржбрж╛рж░ ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛ', async () => {
    // рзз. ржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐
    const order = await createOrder({
      user_id: 1,
      service_id: 1,
      quantity: 100
    });
    
    // рзи. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░рзЗ ржлрж░ржУржпрж╝рж╛рж░рзНржб
    const forwardResult = await forwardOrderToProvider(order);
    expect(forwardResult.success).toBe(true);
    
    // рзй. рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ рж╕рж┐ржЩрзНржХ
    await syncProviderOrderStatus(order.id);
    
    // рзк. ржЗржЙржЬрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржЪрзЗржХ
    const userStatus = await getUserOrderStatus(order.id);
    expect(userStatus.status).not.toBe('failed');
  });
});
```

## рззрзж. рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ ржмрж┐ржмрзЗржЪржирж╛

### рззрзж.рзз API рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐
- **Authentication**: рж╕ржм API ржПржирзНржбржкржпрж╝рзЗржирзНржЯрзЗ ржкрзНрж░ржкрж╛рж░ ржЕржерзЗржирзНржЯрж┐ржХрзЗрж╢ржи ржЪрзЗржХ
- **Authorization**: ржПржбржорж┐ржи API рж╢рзБржзрзБ ржПржбржорж┐ржирж░рж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ
- **Rate Limiting**: рж░рж┐рж╕рж╛ржмржорж┐ржЯ API рждрзЗ рж░рзЗржЯ рж▓рж┐ржорж┐ржЯрж┐ржВ
- **Input Validation**: рж╕ржм ржЗржиржкрзБржЯ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи

### рззрзж.рзи ржбрзЗржЯрж╛ рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐
- **API Key Protection**: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ API ржХрзА ржПржиржХрзНрж░рж┐ржкрзНржЯ ржХрж░рзЗ рж░рж╛ржЦрж╛
- **Sensitive Data Logging**: рж╕рзЗржирж╕рж┐ржЯрж┐ржн ржбрзЗржЯрж╛ рж▓ржЧ ржирж╛ ржХрж░рж╛
- **Database Security**: ржбрзЗржЯрж╛ржмрзЗрж╕ ржХрж╛ржирзЗржХрж╢ржи рж╕рж┐ржХрж┐ржЙрж░ рж░рж╛ржЦрж╛

## рззрзз. ржкрж╛рж░ржлрж░ржорзЗржирзНрж╕ ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи

### рззрзз.рзз ржбрзЗржЯрж╛ржмрзЗрж╕ ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи
```sql
-- ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржЗржиржбрзЗржХрзНрж╕
CREATE INDEX idx_neworder_status ON neworder(status);
CREATE INDEX idx_neworder_provider_id ON neworder(provider_id);
CREATE INDEX idx_neworder_user_id_status ON neworder(user_id, status);
CREATE INDEX idx_provider_order_tracking_order_id ON provider_order_tracking(order_id);
CREATE INDEX idx_provider_api_log_order_id ON provider_api_log(order_id);
```

### рззрзз.рзи API ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи
- **Caching**: ржлрзНрж░рж┐ржХрзЛржпрж╝рзЗржирзНржЯ API рж░рзЗрж╕ржкржирзНрж╕ ржХрзНржпрж╛рж╢ ржХрж░рж╛
- **Pagination**: ржмржбрж╝ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржЬржирзНржп ржкрзЗржЬрж┐ржирзЗрж╢ржи
- **Background Jobs**: ржнрж╛рж░рзА ржХрж╛ржЬ ржмрзНржпрж╛ржХржЧрзНрж░рж╛ржЙржирзНржбрзЗ ржХрж░рж╛

## рззрзи. ржоржирж┐ржЯрж░рж┐ржВ ржПржмржВ рж▓ржЧрж┐ржВ

### рззрзи.рзз рж▓ржЧрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо
```typescript
// lib/logger.ts
export class OrderLogger {
  static logOrderCreation(order: NewOrder) {
    console.log(`[ORDER_CREATED] Order ${order.id} created for user ${order.user_id}`);
  }
  
  static logOrderForward(order: NewOrder, provider: Provider) {
    console.log(`[ORDER_FORWARD] Order ${order.id} forwarded to provider ${provider.name}`);
  }
  
  static logOrderResubmit(order: NewOrder) {
    console.log(`[ORDER_RESUBMIT] Order ${order.id} resubmitted`);
  }
  
  static logBalanceCheck(provider: Provider, balance: number) {
    console.log(`[BALANCE_CHECK] Provider ${provider.name} balance: ${balance}`);
  }
}
```

### рззрзи.рзи ржоржирж┐ржЯрж░рж┐ржВ ржорзЗржЯрзНрж░рж┐ржХрзНрж╕
- **Order Success Rate**: ржЕрж░рзНржбрж╛рж░ рж╕рж╛ржХрж╕рзЗрж╕ рж░рзЗржЯ
- **Provider Response Time**: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ рж░рзЗрж╕ржкржирзНрж╕ ржЯрж╛ржЗржо
- **Balance Check Frequency**: ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржлрзНрж░рж┐ржХрзЛржпрж╝рзЗржирзНрж╕рж┐
- **Resubmit Rate**: рж░рж┐рж╕рж╛ржмржорж┐ржЯ рж░рзЗржЯ

## рззрзй. ржбрж┐ржкрзНрж▓ржпрж╝ржорзЗржирзНржЯ ржкрзНрж▓рзНржпрж╛ржи

### рззрзй.рзз ржбрзЗржЯрж╛ржмрзЗрж╕ ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи
```sql
-- migration_add_resubmit_features.sql
BEGIN;

-- ржирждрзБржи ржХрж▓рж╛ржо ржпрзЛржЧ ржХрж░рж╛
ALTER TABLE neworder ADD COLUMN IF NOT EXISTS resubmit_count INTEGER DEFAULT 0;
ALTER TABLE neworder ADD COLUMN IF NOT EXISTS last_resubmit_at TIMESTAMP;
ALTER TABLE neworder ADD COLUMN IF NOT EXISTS balance_check_status VARCHAR(50);
ALTER TABLE neworder ADD COLUMN IF NOT EXISTS user_visible_status VARCHAR(50);
ALTER TABLE neworder ADD COLUMN IF NOT EXISTS admin_visible_status VARCHAR(50);

-- ржЗржиржбрзЗржХрзНрж╕ ржпрзЛржЧ ржХрж░рж╛
CREATE INDEX IF NOT EXISTS idx_neworder_resubmit_count ON neworder(resubmit_count);
CREATE INDEX IF NOT EXISTS idx_neworder_balance_check_status ON neworder(balance_check_status);

-- ржмрж░рзНрждржорж╛ржи ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░рж╛
UPDATE neworder SET 
  user_visible_status = CASE 
    WHEN status IN ('failed', 'cancelled') THEN 'pending'
    ELSE status
  END,
  admin_visible_status = status
WHERE user_visible_status IS NULL;

COMMIT;
```

### рззрзй.рзи ржбрж┐ржкрзНрж▓ржпрж╝ржорзЗржирзНржЯ рж╕рзНржЯрзЗржкрж╕
1. **ржбрзЗржЯрж╛ржмрзЗрж╕ ржмрзНржпрж╛ржХржЖржк**: ржкрзНрж░рзЛржбрж╛ржХрж╢ржи ржбрзЗржЯрж╛ржмрзЗрж╕рзЗрж░ ржмрзНржпрж╛ржХржЖржк ржирзЗржУржпрж╝рж╛
2. **ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи рж░рж╛ржи**: ржирждрзБржи рж╕рзНржХрж┐ржорж╛ ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржЪрж╛рж▓рж╛ржирзЛ
3. **API ржбрж┐ржкрзНрж▓ржпрж╝**: ржирждрзБржи API ржПржирзНржбржкржпрж╝рзЗржирзНржЯ ржбрж┐ржкрзНрж▓ржпрж╝ ржХрж░рж╛
4. **ржлрзНрж░ржирзНржЯржПржирзНржб ржбрж┐ржкрзНрж▓ржпрж╝**: UI ржкрж░рж┐ржмрж░рзНрждржи ржбрж┐ржкрзНрж▓ржпрж╝ ржХрж░рж╛
5. **ржЯрзЗрж╕рзНржЯрж┐ржВ**: ржкрзНрж░рзЛржбрж╛ржХрж╢ржирзЗ ржЯрзЗрж╕рзНржЯ ржХрж░рж╛
6. **ржоржирж┐ржЯрж░рж┐ржВ**: рж╕рж┐рж╕рзНржЯрзЗржо ржоржирж┐ржЯрж░ ржХрж░рж╛

## рззрзк. ржнржмрж┐рж╖рзНржпрзО ржЙржирзНржирждрж┐

### рззрзк.рзз рж╕ржорзНржнрж╛ржмрзНржп ржлрж┐ржЪрж╛рж░
- **Auto Balance Reload**: ржЕржЯрзЛржорзЗржЯрж┐ржХ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ рж░рж┐рж▓рзЛржб
- **Provider Failover**: ржПржХржЯрж┐ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржлрзЗржЗрж▓ рж╣рж▓рзЗ ржЕржирзНржпржЯрж┐рждрзЗ ржкрж╛ржарж╛ржирзЛ
- **Smart Retry Logic**: рж╕рзНржорж╛рж░рзНржЯ рж░рж┐ржЯрзНрж░рж╛ржЗ рж▓ржЬрж┐ржХ
- **Real-time Notifications**: рж░рж┐ржпрж╝рзЗрж▓-ржЯрж╛ржЗржо ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи

### рззрзк.рзи рж╕рзНржХрзЗрж▓рж┐ржВ ржкрзНрж▓рзНржпрж╛ржи
- **Database Sharding**: ржбрзЗржЯрж╛ржмрзЗрж╕ рж╢рж╛рж░рзНржбрж┐ржВ
- **Microservices**: ржорж╛ржЗржХрзНрж░рзЛрж╕рж╛рж░рзНржнрж┐рж╕ ржЖрж░рзНржХрж┐ржЯрзЗржХржЪрж╛рж░
- **Load Balancing**: рж▓рзЛржб ржмрзНржпрж╛рж▓рзЗржирзНрж╕рж┐ржВ
- **Caching Layer**: ржХрзНржпрж╛рж╢рж┐ржВ рж▓рзЗржпрж╝рж╛рж░

## рззрзл. рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржЧрж╛ржЗржб

### рззрзл.рзз рж╕рж╛ржзрж╛рж░ржг рж╕ржорж╕рзНржпрж╛

#### рж╕ржорж╕рзНржпрж╛: рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржХрж╛ржЬ ржХрж░ржЫрзЗ ржирж╛
**рж╕ржорж╛ржзрж╛ржи**:
1. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ API ржХрзА ржЪрзЗржХ ржХрж░рзБржи
2. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ ржХрж░рзБржи
3. ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржХрж╛ржирзЗржХржЯрж┐ржнрж┐ржЯрж┐ ржЪрзЗржХ ржХрж░рзБржи
4. API рж▓ржЧ ржЪрзЗржХ ржХрж░рзБржи

#### рж╕ржорж╕рзНржпрж╛: ржЗржЙржЬрж╛рж░ ржлрзЗржЗрж▓рзНржб рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржжрзЗржЦрждрзЗ ржкрж╛ржЪрзНржЫрзЗ
**рж╕ржорж╛ржзрж╛ржи**:
1. ржлрзНрж░ржирзНржЯржПржирзНржб рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░ ржЪрзЗржХ ржХрж░рзБржи
2. API рж░рзЗрж╕ржкржирзНрж╕ ржЪрзЗржХ ржХрж░рзБржи
3. ржбрзЗржЯрж╛ржмрзЗрж╕ user_visible_status ржлрж┐рж▓рзНржб ржЪрзЗржХ ржХрж░рзБржи

#### рж╕ржорж╕рзНржпрж╛: ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ рж╕рж┐ржЩрзНржХ ржХрж╛ржЬ ржХрж░ржЫрзЗ ржирж╛
**рж╕ржорж╛ржзрж╛ржи**:
1. ржХрзНрж░ржи ржЬржм ржЪрзЗржХ ржХрж░рзБржи
2. ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ API рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржЪрзЗржХ ржХрж░рзБржи
3. ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржЯрж╛ржЗржоржЖржЙржЯ ржЪрзЗржХ ржХрж░рзБржи

## рззрзм. рж╕ржВржХрзНрж╖рж┐ржкрзНржд рж╕рж╛рж░рж╛ржВрж╢

### тЬЕ рж╕ржорзНржкржирзНржи ржХрж╛ржЬ
- ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЕрж░рзНржбрж╛рж░ ржлрж░ржУржпрж╝рж╛рж░рзНржбрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо
- ржЕрж░рзНржбрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ рж╕рж┐ржЩрзНржХ рж╕рж┐рж╕рзНржЯрзЗржо
- ржПржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓рзЗ ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕
- ржбрзЗржЯрж╛ржмрзЗрж╕ рж╕рзНржХрж┐ржорж╛ ржЖржкржбрзЗржЯ
- API ржПржирзНржбржкржпрж╝рзЗржирзНржЯ рждрзИрж░рж┐

### тЭМ ржмрж╛ржХрж┐ ржХрж╛ржЬ
- ржЗржЙржЬрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ (ржкрзЗржирзНржбрж┐ржВ ржжрзЗржЦрж╛ржирзЛ)
- рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕрж░рзНржбрж╛рж░ ржлрж┐ржЪрж╛рж░
- ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ рж╕рж┐рж╕рзНржЯрзЗржо
- рзй-ржбржЯ ржорзЗржирзБрждрзЗ рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕржкрж╢ржи
- UI ржЖржкржбрзЗржЯ

### ЁЯОп ржкрж░ржмрж░рзНрждрзА ржкржжржХрзНрж╖рзЗржк
1. ржЗржЙржЬрж╛рж░ рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯ ржХрж░рж╛
2. рж░рж┐рж╕рж╛ржмржорж┐ржЯ API рждрзИрж░рж┐ ржХрж░рж╛
3. ржПржбржорж┐ржи ржкрзНржпрж╛ржирзЗрж▓рзЗ рж░рж┐рж╕рж╛ржмржорж┐ржЯ ржЕржкрж╢ржи ржпрзЛржЧ ржХрж░рж╛
4. ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЪрзЗржХ рж╕рж┐рж╕рзНржЯрзЗржо ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯ ржХрж░рж╛
5. ржЯрзЗрж╕рзНржЯрж┐ржВ ржПржмржВ ржбрж┐ржкрзНрж▓ржпрж╝ржорзЗржирзНржЯ

---

**ржирзЛржЯ**: ржПржЗ ржбржХрзБржорзЗржирзНржЯржЯрж┐ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛ ржПржмржВ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржХрж╛ржЬрзЗрж░ ржПржХржЯрж┐ рж╕ржорзНржкрзВрж░рзНржг ржЧрж╛ржЗржбред рж╕ржм ржХрж╛ржЬ рж╕ржорзНржкржирзНржи рж╣рж▓рзЗ ржПржХржЯрж┐ рж╕ржорзНржкрзВрж░рзНржг ржкрзНрж░рзЛржнрж╛ржЗржбрж╛рж░ ржЕрж░рзНржбрж╛рж░ ржЯрзНрж░рзНржпрж╛ржХрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржмрзЗ ржпрж╛ ржЗржЙржЬрж╛рж░ ржПржмржВ ржПржбржорж┐ржиржжрзЗрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ ржЕржнрж┐ржЬрзНржЮрждрж╛ ржкрзНрж░ржжрж╛ржи ржХрж░ржмрзЗред