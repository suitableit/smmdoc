
model Users {
  id                    Int                    @id @default(autoincrement())
  username              String?                @unique
  name                  String?
  email                 String?                @unique
  contactMessages       ContactMessages[]
  repliedContactMessages ContactMessages[]      @relation("RepliedByUser")

  @@map("users")
}

model ContactSettings {
  id                    Int               @id @default(autoincrement())
  contactSystemEnabled  Boolean           @default(true)
  maxPendingContacts    String            @default("3")
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt
  categories           ContactCategories[]

  @@map("contact_settings")
}

model ContactCategories {
  id                Int              @id @default(autoincrement())
  name              String
  contactSettingsId Int?
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  contactSettings   ContactSettings? @relation(fields: [contactSettingsId], references: [id])
  messages          ContactMessages[]

  @@map("contact_categories")
}

model ContactMessages {
  id          Int             @id @default(autoincrement())
  userId      Int
  subject     String
  message     String          @db.Text
  status      String          @default("Unread")
  categoryId  Int
  attachments String?         @db.Text
  adminReply  String?         @db.Text
  repliedAt   DateTime?
  repliedBy   Int?
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt

  user          Users            @relation(fields: [userId], references: [id])
  category      ContactCategories @relation(fields: [categoryId], references: [id])
  repliedByUser Users?           @relation("RepliedByUser", fields: [repliedBy], references: [id])

  @@index([userId])
  @@index([categoryId])
  @@index([status])
  @@map("contact_messages")
}
